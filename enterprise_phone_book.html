<!DOCTYPE html>
<html class="ui-mobile" lang="en">
  <head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <title>企业电话簿</title>

    <link href="css/jquery.mobile.css"  rel="stylesheet" type="text/css" />
    <link href="css/jquery-ui.css"  rel="stylesheet" type="text/css" />
    <link href="css/zhiyi-custom-theme.css"  rel="stylesheet" type="text/css" />
    <link href="css/public.css" rel="stylesheet" type="text/css" />

    <script src="javascript/jquery.js" type="text/javascript"></script>
    <script src="javascript/jquery_ujs.js" type="text/javascript"></script>
    <script src="javascript/jquery.mobile.js" type="text/javascript"></script>
    <script src="javascript/public.js" type="text/javascript"></script>
  </head>
  <body id="body">
    <div data-role="page" id="body">
      <div class="navbar" data-role="header">
	<script type="text/javascript">
    	  $(function(){
	      get_servers({
		  url: get_root_organ_path,
		  data: {"organ_id": user.organ_id},
		  callback: function(data){
		      $("h2").html(data.name)
		      list_children(data.id)
		  }
	      })
	  })
	  function get_children(organ_id){
	      alert(organ_id)
	  }
	  function get_users(organs_id){
	      alert(organ_id)
	  }
	  function list_children(organ_id){
	      get_servers({
		  url: get_childs_organ_path,
		  data: {"organ_id": organ_id},
		  callback: function(result){
		      html="";
		      html+="<li data-role='list-divider'>部门总数<span class='ui-li-count'>"+result.length+"</span></li>"
		      for (i in result){
			  html+="<li>";
			  if (result.child){
			      html+="<a href='javascript:void(0)' rel='external' onclick='get_children("+result[i].id+")'>";
			  }else{
			      html+="<a href='javascript:void(0)' rel='external' onclick='get_users("+result[i].id+")'>";
			  }
			  html+="<h3>"+result[i].name+"</h3>";
			  html+="</a>";
			  html+="</li>";
		      }
		      $("#data-list").append(html).listview("refresh");
		  }
	      })
	  }
	</script>
	<h2></h2>
      </div>
      <div data-role="content" id="working-area">
	<div class="row-fluid" id="screen-full">
	  <!-- 企业电话簿  区域-->
	  <ul id="data-list" data-role="listview" data-split-icon="delete" data-filter="true">
	    <ul>
	</div>
      </div>
    </div>

  </body>
</html>










